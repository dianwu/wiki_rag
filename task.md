# 下一步開發計畫

本文件概述了 QNAP Wiki RAG 專案的下一階段開發計畫。

## 1. 優化 MediaWiki 資料擷取 (`ingest.py`)

-   **解析表格資料:** 目前的腳本無法正確處理 MediaWiki 標記語言中的表格。需要更新解析邏輯，以正確提取和格式化表格內容，從而提高資料覆蓋率和檢索準確性。
-   **提取頁面 URL:** 修改資料提取過程，以擷取每個 Wiki 頁面的來源 URL。此 URL 應儲存在向量的中繼資料（metadata）中，以便使用者可以從檢索結果直接存取原始來源頁面。

## 2. 擴展資料來源支援

-   **新增 Jira 匯入功能:** 實作一個新的資料載入器，或修改現有載入器，以支援從 Jira 匯出的資料。這將涉及處理 Jira 資料的特定格式（例如 XML 或 JSON）。

## 3. 實現增量資料更新

-   **支援持續索引:** 重構 `ingest.py` 腳本及其與 ChromaDB 的互動，以允許新增或更新現有文件，而無需完全重建資料庫。這對於維護最新的知識庫至關重要。

## 4. 容器化

-   **建立 Docker 環境:** 已完成 `Dockerfile` 的撰寫與測試，成功將應用程式、依賴與 ChromaDB、FastMCP 等一併容器化。後續可考慮加入 `docker-compose.yml` 以支援多服務協同。

---

## 5. Docker 映像優化與安裝策略

-   **映像檔優化:** 目前在 Docker build 階段安裝所有依賴，導致映像檔體積較大。
-   **後續任務:**
	- 研究並實作「延遲安裝」策略：將部分套件安裝流程延後至容器第一次啟動時（entrypoint 或啟動腳本）再執行。
	- 比較兩種安裝時機的優缺點：
		- **Build 階段安裝（現行做法）**
			- *優點*: 啟動速度快、可重現性高、CI/CD 友善。
			- *缺點*: 映像檔肥大、每次依賴變動都需重建映像。
		- **啟動時安裝（延遲安裝）**
			- *優點*: 初始映像檔較小、可根據需求動態安裝。
			- *缺點*: 第一次啟動較慢、安裝失敗時容器啟動會中斷、可重現性較差、需額外處理快取與權限問題。
	- 根據專案需求選擇最適合的策略，並撰寫相關啟動腳本與說明文件。
